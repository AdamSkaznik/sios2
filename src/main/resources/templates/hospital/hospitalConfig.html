<!DOCTYPE html>
<html xmlns:th="https://www.thymeleaf.org" xmlns:sd="http://www.w3.org/1999/xhtml"
      xmlns:sec="http://www.w3.org/1999/xhtml"
      th:replace="~{/hospital/fragments/layout2::layout(~{::.container-fluid})}">
<head>
    <meta charset="UTF-8">
</head>
<body>
<div class="container-fluid" style="padding-top: 80px" >
<!--    modal addConfig - start-->
    <div class="modal fade" id="addConfig">
        <div class="modal-dialog">
            <div class="modal-content">
            <div class="modal-header">
                <h4> Dodaj konfigurację Oddziału <i class="fa-solid fa-exclamation-circle" style="color: blue"></i></h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
                <div class="modal-body justify-content-center">
                    <div id="modalAddBody"></div>
                </div>
            </div>
        </div>
    </div>
<!--    modal ConfigConfig - end-->
    <!--    modal editConfig - start-->
    <div class="modal fade" id="editConfig">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4> Edytuj konfigurację Oddziału <i class="fa-solid fa-exclamation-circle" style="color: red"></i></h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body justify-content-center">
                    <div id="modalEditBody"></div>
                </div>
            </div>
        </div>
    </div>
    <!--    modal addConfig - end-->
    <!--    modal editConfig - start-->
    <div class="modal fade" id="detailsConfig">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4> Szczegóły konfiguracji Oddziału <i class="fa-solid fa-exclamation-circle" style="color: red"></i></h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body justify-content-center">
                    <div id="modalDetailsBody"></div>
                </div>
            </div>
        </div>
    </div>
    <!--    modal addConfig - end-->
    <!--    modal dla adresu placówki - start-->
    <div class="modal fade" id="showAddressDetails">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title"> Szczegóły adresu <i class="glyphicon glyphicon-info-sign" style="color: blue"></i></h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>
                <div class="modal-body justify-content-center">
                    <div id="modalShowDetailsAddressBody"></div>
                </div>
            </div>
        </div>
    </div>
    <!--    modal dla adresu placówki - end-->
<div class="card">
    <div class="card-body">
<!--        <div class="container">-->
<!--            <button type="button">-->
<!--                <i class="fa-solid fa-plus-circle"> Nowa</i>-->
<!--            </button>-->
<!--        </div>-->
        <div style="text-align: center"><h3> Konfiguracja</h3>
        <br>
        </div>
        <br>
        <div>
            <button type="button" class="btn btn-success btn-add" style="padding-left: 20px; margin-left: 10px" id="addConfigure" aria-hidden="true">
                <i class="fa-solid fa-plus-circle">&nbsp;&nbsp; Nowa konfiguracja</i>
            </button>
            <button type="button" class="btn btn-warning" style="padding-left: 20px; margin-left: 10px; font-family: 'Arial'" id="address">
                <i class="fa-solid fa-hospital">&nbsp;&nbsp; Adres placówki</i>
            </button>
        </div>
<!--        <div>-->
<!--            <button type="button" class="btn btn-success" style="padding-left: 20px; margin-left: 10px" id="address">-->
<!--                <i class="fa-solid fa-hospital">&nbsp;&nbsp; Adres placówki</i>-->
<!--            </button>-->
<!--        </div>-->
        <br><br>
        <table class="table table-bordered table-striped" style="width: 100%" id="glowna" >
            <thead>
            <tr>
                <th>Lp.</th>
                <th>Oddział</th>
                <th>Ilość deklarowanych łóżek na Oddziale</th>
                <th>Ilość łóżek zarezerwowanych przez Kierownictwo (OIOM, Oper.)</th>
                <th>Dodatkowe informacje</th>
                <th>Akcje</th>
            </tr>
            </thead>
        </table>
    </div>
</div>
</div>
</body>
</html>
<script type="text/javascript">
    let table = $('#glowna').DataTable({
        "bAutoWidth": true,
        "sAjaxSource": "/api/hospitalConfig/v1",
        "sAjaxDataProp": "",
        "stateSave": true,
        "aoColumns":
        [
            {
                "mData": null,
                sWidth: '20px',
                "render": function (data, type, full, meta){
                    return meta.index+1;
                }
            },
            {
                "mData":"branch.name"
            },
            {
                "mData": "numberOfBeds"
            },
            {
                "mData": "numberOfBedsLocked"
            },
            {
              "mData": "hospitalConfigDescription"
            },
            {
              "mData": null,
              sWidth: '100px',
              "render": function() {
                  let a = "";
                  a = a + '&nbsp;&nbsp;';
                  a = a + '<a href="#"><span style="color: red" class="fa-solid fa-pencil-square" title="Edycja" id="edit"></span></a>';
                  a = a + '&nbsp;&nbsp;';
                  a = a + '<a href="#"><span style="color: orange" class="fa-solid fa-info-circle" title="Szczegóły" id="details"></span></a>';
                  a = a + '&nbsp;&nbsp;&nbsp;&nbsp;';
                  a = a + '<a href="#"><span style="color: green" class="fa-solid fa-user-doctor" title="Kadra zarządzająca" id="managment"></span></a>';
                  a = a + '&nbsp;&nbsp;&nbsp;&nbsp;';
                  a = a + '<a href="#"><span style="color: red" class="fa-solid fa-user" title="Dyrekcja placówki" id="director"></span></a>';
                  return a;
              }
            },
        ],
        "columnDefs":
        [
            {

            }
        ],
        "language":
            {
                "processing": "Przetwarzanie...",
                "search": "Szukaj:",
                "lengthMenu": "Pokaż _MENU_ pozycji",
                "info": "Pozycje od _START_ do _END_ z _TOTAL_ łącznie",
                "infoEmpty": "Pozycji 0 z 0 dostępnych",
                "infoFiltered": "(filtrowanie spośród _MAX_ dostępnych pozycji)",
                "infoPostFix": "",
                "loadingRecords": "Wczytywanie...",
                "zeroRecords": "Nie znaleziono pasujących pozycji",
                "emptyTable": "Nie znaleziono rekordów",
                "paginate": {
                    "first": "Pierwsza",
                    "previous": "Poprzednia",
                    "next": "Następna",
                    "last": "Ostatnia"
                },
                "aria": {
                    "sortAscending": ": aktywuj, by posortować kolumnę rosnąco",
                    "sortDescending": ": aktywuj, by posortować kolumnę malejąco"
                }
            }
    })
    table.on('order.dt search.dt', function (){
        table.column(0, {search: 'applied', order: 'applied'}).nodes().each(function (cell, i){
            cell.innerHTML = i + 1;
        });
    }).draw();
$('#glowna tbody').on('click', '#edit', function (){
    var data = table.row($(this).parents('tr')).data();
    $('#editConfig').modal();
    show_edit('/hospital/hospitalConfig_edit'+data["id"]);
});

// $(document.getElementById("addConfigure").on('click', function (){
//     $('#addConfig').modal();
//     show_add('/hospital/hospitalConfig_add');
// }));
  $(document).ready(function (){
      $(".btn-add").click(function (){
          $('#addConfig').modal();
          show_add('/hospital/hospitalConfig_add');
      });
  }) ;
  $(document).ready(function (){
    $('#address').click(function (){
        $('#showAddressDetails').modal();
        show_address('/hospital/address');
    });
  });
function show_edit(url){
    $('#modalEditBody').load(url, function (){});
}

function show_add(url){
    $('#modalAddBody').load(url, function(){});
}

function show_address(url){
    $('#modalShowDetailsAddressBody').load(url, function (){});
}
</script>